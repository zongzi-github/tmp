{{ self.title() }}

{{ s('description') }}
小绿有$n$个圣诞球，打算把这$n$个圣诞球装饰到圣诞树上。 这是一棵奇怪的圣诞树，这个圣诞树有$n$个节点，每个节点有两个值$a_{i}$，$b_{i}$小绿每放一个圣诞球在节点$i$，那么就会得到一定的美丽值，我们假定在节点$i$放了圣诞球之后已经放有圣诞球节点集合为$S$，则可以获得$b_{i}$$\sum_{j\notin{S}}$$a_{j}$点美丽值。 一开始小绿只能把圣诞球放在圣诞树的根节点，并获得$0$点美丽值，随后小绿可以把圣诞球放到任何一个点$v$满足${\exists}$$E(u,v),u\in{S},v\notin{S}$，并获得相应的美丽值。 小绿不知道如何才能让圣诞树变得最美丽，你能帮他吗？




{{ s('input format') }}

{{ self.input_file() }}

输入的第一行包含一个正整数 $n$，表示圣诞树的节点个数和圣诞球个数。

输入的第二行包含$n-1$个正整数，第$i$个整数$f_{i}$表示第$i+1$个点的父亲是$f_{i}$。 

接下来的$n$行每行包含两个整数$a_{i}$，$b_{i}$，表示节点$i$的$a_{i}$，$b_{i}$值。

{{ s('output format') }}

{{ self.output_file() }}

输出一个整数表示最大美丽值，这个值可能会很大，请输出$mod998244353$意义下的。


{{ s('sample', 1) }}

{{ self.sample_text() }}

{{ self.title_sample_description() }}

先放在2号节点，再放在4号节点，最后放在3号节点。 

{{ s('subtasks') }}

不要使用markdown原生的表格，使用下列方式渲染一个表格，其中表格存放在试题目录的 `tables` 子目录下。

对于所有测试数据$1 \leq n \leq 100000 ,0<$$a_{i}$，$b_{i}$$\leq 10000$，
保证根节点$a_{1}$，$b_{1}$均为0。


{{ tbl('data') }}

{{ tbl('table', width = [1, 6]) }}



{{ s('scoring') }}

这是评分方法，如果有必要的话。

{{ s('hint') }}

这里是一个非常温馨的提示。